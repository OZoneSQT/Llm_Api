from __future__ import annotations

from pathlib import Path
from typing import Any, Iterable, Iterator, Protocol, TypeVar

T = TypeVar('T')

class Dataset(Protocol[T]):
    column_names: list[str]

    def map(self, *args: Any, **kwargs: Any) -> 'Dataset[Any]': ...

    def filter(self, *args: Any, **kwargs: Any) -> 'Dataset[Any]': ...

    def select(self, *args: Any, **kwargs: Any) -> 'Dataset[Any]': ...

    def save_to_disk(self, path: str | Path, **kwargs: Any) -> None: ...

    def take(self, n: int) -> 'Dataset[Any]': ...

    def remove_columns(self, columns: Iterable[str], **kwargs: Any) -> 'Dataset[Any]': ...

    def __iter__(self) -> Iterator[Any]: ...

    def __len__(self) -> int: ...

    def __getitem__(self, key: Any) -> Any: ...

    def __contains__(self, item: Any) -> bool: ...

    @classmethod
    def from_dict(cls, data: dict[str, Iterable[Any]], **kwargs: Any) -> 'Dataset[Any]': ...

    @classmethod
    def load_from_disk(cls, *args: Any, **kwargs: Any) -> 'Dataset[Any]': ...

    def train_test_split(self, *args: Any, **kwargs: Any) -> 'DatasetDict': ...

class DatasetDict(Protocol):
    def __getitem__(self, key: str) -> Dataset[Any]: ...

    def values(self) -> Iterable[Dataset[Any]]: ...


def load_dataset(*args: Any, **kwargs: Any) -> Dataset[Any]: ...

def load_from_disk(*args: Any, **kwargs: Any) -> Dataset[Any]: ...

def concatenate_datasets(datasets: Iterable[Dataset[Any]], **kwargs: Any) -> Dataset[Any]: ...
